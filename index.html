<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <title>Library Management System</title>

</head>
<body>
    <h1>Library Management System</h1>

    <form id="borrowForm">
        <label for="bookName">Book Name:</label>
        <input type="text" id="bookName" name="bookName">
        <button type="submit">Borrow</button>
    </form>

    <div id="issuedBooks" class="book-container"></div>
    <div id="returnedBooks"></div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        const issuedBooksContainer = document.getElementById('issuedBooks');
        const returnedBooksContainer = document.getElementById('returnedBooks');

        const fetchIssuedBooks = () => {
            axios.get('http://localhost:3000/issued-books')
                .then(response => {
                    const issuedBooks = response.data;
                    issuedBooksContainer.innerHTML = '';
                    issuedBooks.forEach(book => {
                        const bookCard = document.createElement('div');
                        bookCard.className = 'book-card';
                        bookCard.innerHTML = `
                            <p>Book Name: ${book.name}</p>
                            <p>Book Taken On: ${book.borrowedOn}</p>
                            <p>Book Return On: ${book.returnOn}</p>
                            <p>Current Fine: <span id="fine-${book.name}">${book.fine}</span> Rs.</p>
                            <button class="return-book-btn" data-bookname="${book.name}">Return Book</button>
                        `;
                        issuedBooksContainer.appendChild(bookCard);
                    });
                })
                .catch(error => {
                    console.error('Error fetching issued books:', error);
                });
        };

        const fetchReturnedBooks = () => {
            axios.get('http://localhost:3000/returned-books')
                .then(response => {
                    const returnedBooks = response.data;
                    returnedBooksContainer.innerHTML = '<h2>Returned Books</h2>';
                    returnedBooks.forEach(book => {
                        const bookItem = document.createElement('div');
                        bookItem.innerHTML = `
                            <p>Book Name: ${book.name}</p>
                            <p>Book Taken On: ${book.borrowedOn}</p>
                            <p>Book Returned On: ${book.returnedOn}</p>
                            <p>Fine: ${book.fine} Rs.</p>
                        `;
                        returnedBooksContainer.appendChild(bookItem);
                    });
                })
                .catch(error => {
                    console.error('Error fetching returned books:', error);
                });
        };

        fetchIssuedBooks();
        fetchReturnedBooks();

        document.getElementById('borrowForm').addEventListener('submit', (event) => {
            event.preventDefault();
            const bookName = document.getElementById('bookName').value;

            axios.post('http://localhost:3000/borrow', { bookName })
                .then(response => {
                    console.log('Book borrowed:', response.data);
                    fetchIssuedBooks();
                })
                .catch(error => {
                    console.error('Error borrowing book:', error);
                    alert('Error borrowing book. Please try again.');
                });
        });

       
        document.addEventListener('click', (event) => {
            if (event.target.classList.contains('return-book-btn')) {
                const bookName = event.target.dataset.bookname;
                axios.post('http://localhost:3000/return', { bookName })
                    .then(response => {
                        console.log('Book returned:', response.data);
                        fetchIssuedBooks();
                        fetchReturnedBooks();
                    })
                    .catch(error => {
                        console.error('Error returning book:', error);
                        alert('Error returning book. Please try again.');
                    });
            }
        });
    </script>
</body>
</html>

